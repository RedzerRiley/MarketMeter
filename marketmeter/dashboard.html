<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MarketMeter - Catalog</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

  <header class="navbar">
    <div class="nav-inner">
      <a href="#" class="logo">MarketMeter</a>
      <nav>
        <ul class="nav-links">
          <li><a href="dashboard.html" style="color: var(--primary-green); font-weight: 600;">Catalog</a></li>
          <li><a href="submit-price.html">Submit Price</a></li>
          <li><a href="login.html">Login</a></li>
          <li><a href="register.html" class="nav-register">Register</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="main-content">
    <div class="container">
      <div class="section-header">
        <h2>Market Price Catalog</h2>
        <p>Live comparisons of basic goods in your area.</p>
      </div>
      
      <div class="card-container">
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Product</th>
                <th>Market Location</th>
                <th>Posted Price</th>
                <th>SRP</th>
                <th>Date Submitted</th>
                <th>Comparison</th>
              </tr>
            </thead>
            <tbody id="priceTableBody">
              <tr>
                <td>Refined Sugar (1kg)</td>
                <td>Bayan Public Market</td>
                <td>₱85.00</td>
                <td>₱85.00</td>
                <td>Feb 20, 2026</td>
                <td><span class="status at-srp">Equal to SRP</span></td>
              </tr>
              <tr>
                <td>Well-Milled Rice (1kg)</td>
                <td>Pamilihang Bayan ng Rodriguez</td>
                <td>₱55.00</td>
                <td>₱50.00</td>
                <td>Feb 19, 2026</td>
                <td><span class="status above-srp">+₱5.00 (Above)</span></td>
              </tr>
              <tr>
                <td>Red Onion (1kg)</td>
                <td>San Mateo Market</td>
                <td>₱110.00</td>
                <td>₱120.00</td>
                <td>Feb 19, 2026</td>
                <td><span class="status below-srp">-₱10.00 (Below)</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    const srpDatabase = {
        "Well-Milled Rice (1kg)": 50.00,
        "Regular Milled Rice (1kg)": 43.00,
        "Refined Sugar (1kg)": 85.00,
        "Red Onion (1kg)": 120.00,
        "Garlic (1kg)": 90.00,
        "Pork Liempo (1kg)": 315.00,
        "Whole Chicken (1kg)": 200.00
    };

    const formatCurrency = (amount) => `₱${parseFloat(amount).toFixed(2)}`;

    const formatDate = (dateString) => {
        return new Date(dateString).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    };

    function loadDynamicData() {
        const tableBody = document.getElementById('priceTableBody');
        let savedPrices = JSON.parse(localStorage.getItem('marketMeterData')) || [];

        savedPrices.forEach(item => {
            const srp = srpDatabase[item.product] || 0;
            const difference = item.price - srp;

            let badgeHtml = '';
            if (difference > 0) {
                badgeHtml = `<span class="status above-srp">+${formatCurrency(difference)} (Above)</span>`;
            } else if (difference < 0) {
                badgeHtml = `<span class="status below-srp">${formatCurrency(difference)} (Below)</span>`;
            } else {
                badgeHtml = `<span class="status at-srp">Equal to SRP</span>`;
            }

            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${item.product}</td>
                <td>${item.location}</td>
                <td>${formatCurrency(item.price)}</td>
                <td>${formatCurrency(srp)}</td>
                <td>${formatDate(item.date)}</td>
                <td>${badgeHtml}</td>
            `;

            tableBody.insertBefore(newRow, tableBody.firstChild);
        });
    }

    window.onload = loadDynamicData;
  </script>

</body>
</html>